#include <SoftwareSerial.h>
SoftwareSerial BTserial(2, 3); // RX | TX

// Global Variables
const byte NONE = 0;
const byte btn1 = 1;
const byte btn2 = 2;

int port_v = A1;
int port_h = A0;
int keypadPin = A3;
byte key = 0;
int val = 0;
int val_v = 0;
int val_h = 0;

int counterValue = 0;
int sensorValue = 0;
int RXLED = 17;


void setup() {
  //blth
//  pinMode(RXLED, OUTPUT);  // Set RX LED as an output
  BTserial.begin(9600);
  Serial.begin(9600);
  //btns
//  while (!Serial)   {
//    ;
//  }
//  Serial.println(F("Start\n"));
  pinMode(keypadPin, INPUT_PULLUP); // sets analog pin for input
}

void loop() {
  //stick
  val_v = analogRead(port_v);
  val_h = analogRead(port_h);
  Serial.print(" X: ");
  Serial.print(val_h);
  Serial.print(" Y: ");
  Serial.println(val_v);
  Serial.print("\n");
  //IMPORTANT: The complete String has to be of the Form: 1234,1234,1234,1234;

  //(every Value has to be seperated through a comma (',') and the message has to

  //end with a semikolon (';'))

  BTserial.print("H:");
  BTserial.print(val_h);
  BTserial.print(",");
  BTserial.print("V:");
  BTserial.print(val_v);
  BTserial.print(",");

  //btns
  key = getKey();
  if (key == btn1)    {
    Serial.println("btn1");
    
    BTserial.print("Tg1:");
    BTserial.print(val);
    BTserial.print("Tg2:");
    BTserial.print(0);

    Serial.println(val);
  } //val=70
  if (key == btn2)    {
    Serial.println("btn2");
    BTserial.print("Tg1:");
    BTserial.print(0);
    BTserial.print("Tg2:");
    BTserial.print(val);
    
    Serial.println(val);
  } // val=120
  if (key == NONE)    {
    Serial.println("none");
    Serial.println(val);
  } //No button pressed = 1021

  BTserial.print("\n");
  
  Serial.print("\n\n\n\n\n\n\n\n\n\n");


  
//  digitalWrite(RXLED, LOW);   // set the LED on
//  delay(500);           // wait for a second
//  digitalWrite(RXLED, HIGH);    // set the LED off
//  delay(500);

  //message to the receiving device

  delay(100);
}
//////////////////////////////////////////////////////////////
byte getKey()
{

  byte button = 0;
  val = analogRead(keypadPin);

  button = NONE; // use NONE as the default value
  if ( (val >= 52)  &&  (val <= 92)    )   {
    button = btn1;
  }
  else if ( (val >= 104) &&  (val <= 144 ) )   {
    button = btn2;
  }
  return button;
}
